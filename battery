#!/bin/bash

# Return information on battery
# Copyright 2021 obtusedev

set -e

HELP="Usage: $0 [option]\n
-h, --help     print help\n
-V, --version  print version"

VERSION='battery version 1.0'

declare -A battery
battery[path]=$(upower -e | sed -n '2p')
battery[output]=$(upower -i "$BATTERY_PATH")
battery[state]=$(${battery[output]} | awk '/state/ {print $2}')
battery[warning-level]=$(${battery[output]} | awk '/warning-level/ {print $2}')
battery[percentage]=$(${battery[output]} | awk '/percentage/ {print $2}')
battery[capacity]=$(${battery[output]} | awk '/capacity/ {print $2}')
battery[time-to-empty]=''

battery_info_verbose() {
  echo "Battery file located at: ${battery[path]}"
  ${battery[ouput]}
}

if [ $# -eq 0 ]; then
  battery_info_verbose
elif [ $# -eq 1 ]; then
  if [ "$1" == '-V' ] || [ "$1" == '--version' ]; then
    echo "$VERSION"
  elif [ "$1" == '-h' ] || [ "$1" == '--help' ]; then
    echo -e "$HELP"
  else
    echo "Invalid flag $1"
  fi
else
  echo 'Something went wrong'
fi